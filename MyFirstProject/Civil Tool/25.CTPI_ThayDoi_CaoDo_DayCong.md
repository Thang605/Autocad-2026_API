# 25.CTPi_ThayDoi_CaoDo_DayCong Command Documentation

## Command Name
`CTPi_ThayDoi_CaoDo_DayCong`

## Description
Command for adjusting the invert elevation of a single pipe using elevation change delta (thay ??i cao ?? ?áy c?ng b?ng kho?ng thay ??i).

## Functionality
This command allows users to adjust a single pipe's invert elevation by:
- Displaying current pipe invert elevations at start and end
- Showing cover depths at both ends (calculated from reference surface)
- Displaying current pipe slope and length
- Allowing input of elevation change amount (delta) and new pipe slope

## Features

### Input Form
The command opens a Windows Form with:

#### Current Information Display:
- Current start invert elevation
- Current end invert elevation  
- Current cover depth at start (from reference surface)
- Current cover depth at end (from reference surface)
- Current pipe slope percentage
- Pipe length

#### Input Fields:
- **Elevation Change (m)**: Amount to change the start invert elevation (positive = raise, negative = lower)
- **Pipe Slope (%)**: New slope for the pipe

### Workflow
1. User selects a single pipe
2. System analyzes current pipe conditions and calculates cover from reference surface
3. Form displays current information and allows input of elevation change delta and new slope
4. System calculates new pipe elevations: new start = current start + change amount
5. The selected pipe is adjusted with the new start elevation and slope

### Static Memory
The command remembers the last input values for:
- Elevation change amount (`_lastStartInvertElevation`)
- Pipe slope (`_lastSlope`)

These values are displayed as defaults in subsequent runs.

### Technical Implementation
- Uses Civil 3D Pipe API for elevation and slope adjustments
- Calculates cover depths from reference surface when available
- Uses delta/offset approach instead of absolute elevation values
- Validates input ranges and provides warnings for unreasonable values
- Uses `SetSlopeHoldStart()` method to maintain proper drainage
- Works with single pipe only

### Error Handling
- Validates that selected object is a pipe
- Validates numeric input for elevation change and slope
- Checks for reasonable slope values (warns if > 10%)
- Checks for reasonable elevation changes (warns if > 5m)
- Handles reference surface access errors gracefully
- Provides user-friendly error messages

### Validation Features
- **Slope validation**: Warns if slope > 10% or < -10%
- **Elevation change validation**: Warns if change > 5m in either direction
- **Numeric input validation**: Ensures proper number format

### Class Structure
- **Main Command Class**: `CTPi_ThayDoi_CaoDo_DayCong_Commands`
- **Form Class**: `PipeInvertElevationForm`

## Usage
1. Type `CTPi_ThayDoi_CaoDo_DayCong` in AutoCAD command line
2. Select a single pipe to modify
3. Review current information in the form
4. Enter desired elevation change amount (+ to raise, - to lower)
5. Enter desired pipe slope percentage
6. Click OK to apply changes

## Example
- Current start invert: 10.000m
- Enter elevation change: +0.500m
- Result: New start invert = 10.500m

## Notes
- Requires Civil 3D with pipe network objects
- Works with single pipe only (not multiple pipes)
- Cover depths calculated from reference surface when available
- Uses relative elevation changes, not absolute elevations
- Maintains flow direction from start to end
- Calculates end elevation automatically based on start elevation, slope, and pipe length
- Displays comprehensive pipe information including calculated cover depths
