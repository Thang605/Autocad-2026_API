# H??ng d?n s? d?ng Form Thi?t l?p Tr?c ngang Thi?t k?

## Cách s? d?ng l?nh CTSV_VeTracNgangThietKe

### 1. Kh?i ??ng l?nh
- Gõ l?nh: `CTSV_VeTracNgangThietKe`
- Form "Thi?t l?p tham s? v? tr?c ngang thi?t k?" s? hi?n th?

### 2. Các b??c th?c hi?n

#### B??c 1: Ch?n tim ???ng
- Nh?n nút **"Ch?n"** trong m?c "1. Ch?n tim ???ng"
- Ch?n alignment t? model AutoCAD
- Tên alignment s? hi?n th? trong textbox

#### B??c 2: V? trí ??t và Layout  
- Nh?n nút **"Ch?n"** trong m?c "2. V? trí ??t và Layout"
- Ch?n ?i?m ??t tr?c ngang t? model
- Ch?nh s?a Layout Template path n?u c?n
- Ch?n Layout Name phù h?p (A3-TN-1-200, A3-TN-1-500, v.v.)

#### B??c 3: Ngu?n d? li?u tr?c ngang
- Nh?n **"Làm m?i"** ?? load section sources t? alignment
- Ki?m tra checkbox "T? ??ng c?u hình" ?? t? ??ng ch?n sources theo tên
- Trong b?ng DataGrid:
  - Tích/b? tích c?t **"S? d?ng"** ?? b?t/t?t section source
  - Ch?n **Style** phù h?p cho t?ng source

#### B??c 4: Styles
- Ch?n **Section View Style** t? dropdown
- Ch?n **Plot Style** t? dropdown

#### B??c 5: V?t li?u (tùy ch?n)
- Tích **"T?o material list"** n?u mu?n t?o material list
- Nh?p tên material list (m?c ??nh: "B?ng ?ào ??p")

#### B??c 6: B?ng kh?i l??ng (tùy ch?n)  
- Tích **"T?o b?ng kh?i l??ng"** n?u mu?n t?o volume table
- Ch?n v? trí ??t b?ng (TopLeft, TopRight, BottomLeft, BottomRight)

#### B??c 7: Bands và Text (tùy ch?n)
- Tích **"Thêm elevation bands"** ?? thêm bands cao ??
- Tích **"Thêm distance bands"** ?? thêm bands kho?ng cách  
- Tích **"Thêm material text"** ?? thêm text kh?i l??ng

### 3. Hoàn thành
- Nh?n **OK** ?? th?c hi?n l?nh
- Nh?n **H?y** ?? h?y b?

## L?u ý quan tr?ng

### ?i?u ki?n tiên quy?t:
- Document ph?i có alignment v?i sample line group
- Alignment ph?i có các section sources (surfaces, corridors)
- Document ph?i có các styles c?n thi?t

### X? lý l?i:
- N?u không ch?n ???c alignment: Ki?m tra có alignment trong drawing
- N?u không load ???c section sources: Ki?m tra alignment có sample line group
- N?u không t?o ???c bands: Ki?m tra có styles t??ng ?ng trong document
- N?u không t?o ???c material list: Ki?m tra có ?? surfaces (TN và datum)

### Tips s? d?ng:
- Tích "T? ??ng c?u hình" ?? form t? ??ng ch?n section sources phù h?p
- Các surfaces có tên ch?a "TN", "EG", "top", "datum" s? ???c t? ??ng nh?n di?n
- Corridors có tên ch?a tên alignment s? ???c t? ??ng ch?n
- Form có validation ??u vào ?? tránh l?i

### K?t qu? sau khi ch?y:
- Section view group ???c t?o t?i v? trí ch? ??nh
- Các bands ???c thêm theo tùy ch?n
- Material list và volume table ???c t?o n?u ???c ch?n
- B?ng t?ng h?p kh?i l??ng v?t li?u ???c t?o
- Text kh?i l??ng ???c thêm vào section views

## Kh?c ph?c s? c?

### L?i "INTERNAL ERROR":
- ?ã ???c kh?c ph?c b?ng cách tách bi?t transaction
- N?u v?n g?p, restart AutoCAD và th? l?i

### Form không hi?n th? ?úng:
- Ki?m tra document Civil 3D ?ang m?
- ??m b?o có ít nh?t 1 alignment trong drawing

### Styles không load:
- Ki?m tra document có các styles c?n thi?t
- Import styles t? template n?u c?n
